// Generated by CoffeeScript 1.6.3
(function() {
  var Instagram, app, express, port, _;

  _ = require('underscore');

  Instagram = require('instagram-node-lib');

  express = require('express');

  app = express();

  Instagram.set('client_id', process.env.INSTAGRAMID);

  Instagram.set('client_secret', process.env.INSTAGRAMSECRET);

  app.get('/', function(req, res) {
    var name;
    name = req.query.name;
    if (name) {
      return Instagram.users.search({
        q: name,
        complete: function(data, pagination) {
          return Instagram.users.recent({
            user_id: data[0].id,
            complete: function(data, pagination) {
              return res.send(data);
            }
          });
        }
      });
    } else {
      return Instagram.media.popular({
        complete: function(data, pagination) {
          return res.send(data);
        }
      });
    }
  });

  port = process.env.PORT || 3131;

  app.listen(port, function() {
    return console.log('Listening on ' + port);
  });

}).call(this);
